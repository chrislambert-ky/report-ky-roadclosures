<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Analysis of KY Road Closures: by Duration of Road Closures</title>
    <link rel="stylesheet" href="../css/analysis_by_duration.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
</head>
<body>
    <nav class="main-nav">
        <a class="nav-link" href="../index.html">Home</a>
        <a class="nav-link" href="analysis_by_count.html">Analysis by Count</a>
        <a class="nav-link" href="analysis_by_duration.html">Analysis by Duration</a>
        <a class="nav-link" href="analysis_by_map.html">Map View</a>
        <a class="nav-link" href="analysis_by_table.html">Table View</a>
        <a class="nav-link" href="powerbi.html">Power BI Dashboard</a>
        <a class="nav-link" href="about.html">About</a>
    </nav>
    <div style="text-align: center;">
        <h1>Interactive Analysis of KY Road Closures: by Duration of Closures</h1>
        <h2>This page will provide analysis of road closures by duration.</h2>
        <h2>Data refreshes daily 12:30am EST</h2>
    </div>
<!-- copied and pasted from the apache echart site -->
<!-- Now I need to customize with my data -->
<div id="main" style="width:600px;height:400px;margin:2rem auto;">
<script>
var chartDom = document.getElementById('main');
var myChart = echarts.init(chartDom);

// Fetch data and create chart
fetch('../data/data_v4_final_roadclosures.json')
  .then(response => response.json())
  .then(data => {
    // Sum duration hours by year
    const yearDurations = {};
    data.forEach(closure => {
      // Extract the year from the reported date
      const year = new Date(closure.Reported_On).getFullYear();
      // Convert duration to number, default to 0 if empty
      const duration = parseFloat(closure.Duration_Hours) || 0;
      // Add this closure's duration to the year's total
      yearDurations[year] = (yearDurations[year] || 0) + duration;
    });
    
    // Convert to arrays for chart - ECharts needs arrays not objects
    const years = Object.keys(yearDurations).sort();
    const durations = years.map(year => yearDurations[year]);
    
    // Set up the chart configuration
    const option = {
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
      },
      xAxis: {
        type: 'category',
        data: years,
        axisTick: {
          alignWithLabel: true
        }
      },
      yAxis: {
        type: 'value'
      },
      series: [{
        name: 'Total Duration (Hours)',
        type: 'bar',
        barWidth: '60%',
        data: durations
      }]
    };
    
    // Apply the configuration to create the chart
    myChart.setOption(option);
  });
</script>
</div>

</body>
</html>
