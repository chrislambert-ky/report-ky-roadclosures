<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PGFTJRPTPX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-PGFTJRPTPX');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Analysis of KY Road Closures: by Count of Road Closures</title>
    <link rel="stylesheet" href="../css/apache-viz.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
</head>
<body>
    <nav class="main-nav">
        <a class="nav-link" href="../index.html">Home</a>
        <a class="nav-link" href="analysis_by_count.html">Analysis by Count</a>
        <a class="nav-link" href="analysis_by_duration.html">Analysis by Duration</a>
        <a class="nav-link" href="analysis_by_map.html">Map View</a>
        <a class="nav-link" href="analysis_by_table.html">Table View</a>
        <a class="nav-link" href="powerbi.html">Power BI Dashboard</a>
        <a class="nav-link" href="about.html">About</a>
    </nav>
    <div style="text-align: center;">
        <h1>Interactive Analysis of KY Road Closures: by Count of Road Closures</h1>
        <h2>This page will provide analysis of road closures by count.</h2>
        <h2>Data refreshes daily 12:30am EST</h2>
    </div>
<!-- copied and pasted from the apache echart site -->
<!-- Now I need to customize with my data -->
<div id="main" style="width:600px;height:400px;margin:2rem auto;">
<script>
var chartDom = document.getElementById('main');
var myChart = echarts.init(chartDom);

// Fetch data and create chart
fetch('../data/data_v4_final_roadclosures.json')
  .then(response => response.json())
  .then(data => {
    // Count closures by year
    const yearCounts = {};
    data.forEach(closure => 
    {
      // Extract the year from the reported date
      const year = new Date(closure.Reported_On).getFullYear();
      // Add 1 to this year's count (create year if it doesn't exist)
      yearCounts[year] = (yearCounts[year] || 0) + 1;
    });
    
    // Convert to arrays for chart - ECharts needs arrays not objects
    const years = Object.keys(yearCounts).sort();
    const counts = years.map(year => yearCounts[year]);
    
    // Set up the chart configuration
    const option = {
      tooltip: 
      {
        trigger: 'axis',
        axisPointer: 
        {
          type: 'shadow'
        }
      },
      grid: 
      {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
      },
      xAxis: 
      {
        type: 'category',
        data: years,
        axisTick: {
          alignWithLabel: true
        }
      },
      yAxis: 
      {
        type: 'value'
      },
      series: 
      [{
        name: 'Road Closures',
        type: 'bar',
        barWidth: '60%',
        data: counts
      }]
    };
    
    // Apply the configuration to create the chart
    myChart.setOption(option);
  });
</script>
</div>

</body>
</html>
